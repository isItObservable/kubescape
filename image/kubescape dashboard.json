{"version":17,"variables":[],"tiles":{"1":{"title":"","type":"data","subType":"dql-builder-metrics","query":"timeseries avg(dt.kubernetes.container.cpu_usage), by: { k8s.deployment.name, k8s.daemonset.name }, filter: { matchesValue(k8s.namespace.name, \"kubescape\") }\n| fieldsAdd value.A = arrayAvg(`avg(dt.kubernetes.container.cpu_usage)`)","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisScaling":"auto","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":["interval","value.A"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.kubernetes.container.cpu_usage)"]},"leftYAxisSettings":{"isLabelVisible":true,"label":"Kubernetes: Container - CPU usage"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[{"fields":["avg(dt.kubernetes.container.cpu_usage)"],"value":"sparkline","id":1741604881379}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":true},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"queryConfig":{"version":"13.0.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"dt.kubernetes.container.cpu_usage","aggregation":"avg"},"by":["k8s.deployment.name","k8s.daemonset.name"],"filter":"k8s.namespace.name = \"kubescape\""}]},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"2":{"title":"","type":"data","subType":"dql-builder-metrics","query":"timeseries avg(dt.kubernetes.container.memory_working_set), by: { k8s.deployment.name, k8s.daemonset.name }, filter: { matchesValue(k8s.namespace.name, \"kubescape\") }\n| fieldsAdd value.A = arrayAvg(`avg(dt.kubernetes.container.memory_working_set)`)","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisScaling":"auto","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":["interval","value.A"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(dt.kubernetes.container.memory_working_set)"]},"leftYAxisSettings":{"isLabelVisible":true,"label":"Kubernetes: Container - CPU usage"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[{"fields":["avg(dt.kubernetes.container.memory_working_set)"],"value":"sparkline","id":1741627568826}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":true},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"queryConfig":{"version":"13.0.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"dt.kubernetes.container.memory_working_set","aggregation":"avg"},"by":["k8s.deployment.name","k8s.daemonset.name"],"filter":"k8s.namespace.name = \"kubescape\""}]},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"3":{"title":"","type":"markdown","content":"# Resource usage"},"4":{"title":"Heap size","type":"data","subType":"dql-builder-metrics","query":"timeseries avg(process.runtime.go.mem.heap_sys), by: { dt.kubernetes.workload.name }, filter: { matchesValue(k8s.namespace.name, \"kubescape\") }\n| fieldsAdd value.A = arrayAvg(`avg(process.runtime.go.mem.heap_sys)`)","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(process.runtime.go.mem.heap_sys)"]},"xAxisScaling":"auto","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":["interval","value.A"],"leftYAxisSettings":{"isLabelVisible":true,"label":"kubescape_worker_nodes_count"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[{"fields":["avg(process.runtime.go.mem.heap_sys)"],"value":"sparkline","id":1741775418949}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":true},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"queryConfig":{"version":"13.0.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"process.runtime.go.mem.heap_sys","aggregation":"avg"},"by":["dt.kubernetes.workload.name"],"filter":"k8s.namespace.name = kubescape"}]},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"5":{"title":"response time by component","type":"data","query":"fetch spans, from: -30m, samplingRatio: 1, scanLimitGBytes: 50\n\n// if in \"requests\" mode\n| filter request.is_root_span == true AND isNotNull(endpoint.name)\n\n// based on the applied filters\n| filter matchesValue(`k8s.namespace.name`, \"kubescape\") \n// calculate multiplicity based on sampling\n| fieldsAdd sampling.probability = (power(2, 56) - coalesce(sampling.threshold, 0)) * power(2, -56), sampling.multiplicity = 1/sampling.probability, multiplicity = coalesce(sampling.multiplicity, 1) * coalesce(aggregation.count, 1) * dt.system.sampling_ratio\n| fieldsAdd endpoint.name\n// construct fields\n| fieldsAdd request.status_code = if(request.is_failed, \"Failure\", else: \"Success\")\n\n| fieldsAdd aggregation.duration_avg = coalesce(aggregation.duration_sum/aggregation.count, duration)\n// add entity lookups\n| fieldsAdd dt.entity.service.entity.name = entityAttr(dt.entity.service, \"entity.name\")\n| summarize {\n    \n    duration_p95 = percentile(duration, 95),\n   \n  \n   \n    failure_rate = round(toDouble(sum(if(request.status_code == \"Failure\", `multiplicity`, else: 0)) / sum(`multiplicity`)), decimals: 3)\n  }, by: { dt.entity.service.entity.name ,bin(start_time, 30s)}","visualization":"lineChart","visualizationSettings":{"autoSelectVisualization":false,"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","fieldMapping":{"timestamp":"bin(start_time, 30s)","leftAxisValues":["duration_p95"]},"xAxisScaling":"auto","xAxisLabel":"bin(start_time, 30s)","xAxisIsLabelVisible":false,"hiddenLegendFields":["dt.entity.service.entity","endpoint","avg_duration","duration_p95","count","failed","failure_rate"],"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}}},"7":{"title":"Number of Goroutines","type":"data","subType":"dql-builder-metrics","query":"timeseries avg(process.runtime.go.goroutines), by: { dt.kubernetes.workload.name }, filter: { matchesValue(k8s.namespace.name, \"kubescape\") }\n| fieldsAdd value.A = arrayAvg(`avg(process.runtime.go.goroutines)`)","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(process.runtime.go.goroutines)"]},"xAxisScaling":"auto","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":["interval","value.A"],"leftYAxisSettings":{"isLabelVisible":true,"label":"kubescape_worker_nodes_count"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[{"fields":["avg(process.runtime.go.goroutines)"],"value":"sparkline","id":1741775419061}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":true},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"queryConfig":{"version":"13.0.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"process.runtime.go.goroutines","aggregation":"avg"},"by":["dt.kubernetes.workload.name"],"filter":"k8s.namespace.name = kubescape"}]},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"8":{"title":"amount of Ns stopped by the GC","type":"data","subType":"dql-builder-metrics","query":"timeseries avg(process.runtime.go.gc.pause_ns), by: { dt.kubernetes.workload.name }, filter: { matchesValue(k8s.namespace.name, \"kubescape\") }\n| fieldsAdd value.A = arrayAvg(`avg(process.runtime.go.gc.pause_ns)`)","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(process.runtime.go.gc.pause_ns)"]},"xAxisScaling":"auto","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":["interval","value.A"],"leftYAxisSettings":{"isLabelVisible":true,"label":"kubescape_worker_nodes_count"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[{"fields":["avg(process.runtime.go.gc.pause_ns)"],"value":"sparkline","id":1741775419157}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":true},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"queryConfig":{"version":"13.0.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"process.runtime.go.gc.pause_ns","aggregation":"avg"},"by":["dt.kubernetes.workload.name"],"filter":"k8s.namespace.name = kubescape"}]},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"9":{"title":"","type":"markdown","content":"# Go runtime"},"10":{"title":"failure rate component","type":"data","query":"fetch spans, from: -30m, samplingRatio: 1, scanLimitGBytes: 50\n\n// if in \"requests\" mode\n| filter request.is_root_span == true AND isNotNull(endpoint.name)\n\n// based on the applied filters\n| filter matchesValue(`k8s.namespace.name`, \"kubescape\") \n// calculate multiplicity based on sampling\n| fieldsAdd sampling.probability = (power(2, 56) - coalesce(sampling.threshold, 0)) * power(2, -56), sampling.multiplicity = 1/sampling.probability, multiplicity = coalesce(sampling.multiplicity, 1) * coalesce(aggregation.count, 1) * dt.system.sampling_ratio\n| fieldsAdd endpoint.name\n// construct fields\n| fieldsAdd request.status_code = if(request.is_failed, \"Failure\", else: \"Success\")\n\n| fieldsAdd aggregation.duration_avg = coalesce(aggregation.duration_sum/aggregation.count, duration)\n// add entity lookups\n| fieldsAdd dt.entity.service.entity.name = entityAttr(dt.entity.service, \"entity.name\")\n| summarize {\n    \n   \n  \n   \n    failure_rate = round(toDouble(sum(if(request.status_code == \"Failure\", `multiplicity`, else: 0)) / sum(`multiplicity`)), decimals: 3) * 100\n  }, by: { dt.entity.service.entity.name ,bin(start_time, 30s)}","visualization":"lineChart","visualizationSettings":{"autoSelectVisualization":false,"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"smooth","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear","categoryAxisLabel":"dt.entity.service.entity.name","valueAxisLabel":"failure_rate","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","fieldMapping":{"timestamp":"bin(start_time, 30s)","leftAxisValues":["failure_rate"]},"xAxisScaling":"auto","xAxisLabel":"bin(start_time, 30s)","xAxisIsLabelVisible":false,"hiddenLegendFields":["dt.entity.service.entity","endpoint","avg_duration","duration_p95","count","failed","failure_rate"],"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{"value":"failure_rate"},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"},"dataMapping":{"value":"failure_rate"},"label":{"showLabel":true,"label":"failure_rate"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"timeframe":{"tileTimeframeEnabled":true,"tileTimeframe":{"from":"now()-2h","to":"now()"}}},"11":{"title":"","type":"markdown","content":"# Kubescape components"},"12":{"title":"Service having errors","type":"data","query":"fetch spans, from: -30m, samplingRatio: 1, scanLimitGBytes: 50\n\n// if in \"requests\" mode\n| filter request.is_root_span == true AND isNotNull(endpoint.name)\n\n// based on the applied filters\n| filter matchesValue(`k8s.namespace.name`, \"kubescape\") and request.is_failed /* request.status_code condition is based on these attributes */ \n\n// calculate multiplicity based on sampling\n| fieldsAdd sampling.probability = (power(2, 56) - coalesce(sampling.threshold, 0)) * power(2, -56), sampling.multiplicity = 1/sampling.probability, multiplicity = coalesce(sampling.multiplicity, 1) * coalesce(aggregation.count, 1) * dt.system.sampling_ratio\n| fieldsAdd endpoint.name\n// construct fields\n| fieldsAdd request.status_code = if(request.is_failed, \"Failure\", else: \"Success\")\n\n| fieldsAdd aggregation.duration_avg = coalesce(aggregation.duration_sum/aggregation.count, duration)\n// add entity lookups\n| summarize {\n    \n    count = sum(`multiplicity`),\n    failed = sum(if(request.status_code == \"Failure\", `multiplicity`, else: 0)),\n    failure_rate = round(toDouble(sum(if(request.status_code == \"Failure\", `multiplicity`, else: 0)) / sum(`multiplicity`)), decimals: 3)\n  }, by: { service.name,  endpoint.name }\n","visualization":"table","visualizationSettings":{"autoSelectVisualization":false,"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"13":{"title":"Number of Alert reported","type":"data","subType":"dql-builder-metrics","query":"timeseries { avg(node_agent_rule_counter), avg(node_agent_alert_counter) }\n| fieldsAdd node_agent_rule_counter = \"avg(node_agent_rule_counter)\"\n| fieldsAdd value.A = arrayAvg(`avg(node_agent_rule_counter)`)\n| fieldsAdd node_agent_alert_counter = \"avg(node_agent_alert_counter)\"\n| fieldsAdd value.B = arrayAvg(`avg(node_agent_alert_counter)`)","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","bandChartSettings":{"lower":"avg(node_agent_rule_counter)","upper":"avg(node_agent_alert_counter)"},"xAxisScaling":"auto","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":["interval","value.A"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(node_agent_rule_counter)","avg(node_agent_alert_counter)"]},"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[{"fields":["avg(node_agent_rule_counter)","avg(node_agent_alert_counter)"],"value":"sparkline","id":1741776572222}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":true},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"queryConfig":{"version":"13.0.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"node_agent_rule_counter","aggregation":"avg"}},{"id":"B","isEnabled":true,"datatype":"metrics","metric":{"key":"node_agent_alert_counter","aggregation":"avg"}}]},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"14":{"title":"Log having errors","type":"data","query":"fetch logs\n| filter k8s.namespace.name == \"kubescape\"\n| parse log, \"JSON:jsonlog\"\n| fieldsadd kubescape_level = jsonlog[level], kubescape_msg = jsonlog[msg], kubescape_error = jsonlog[error]\n| filter kubescape_msg != \"Exec from malicious source\"\n| fields timestamp, dt.kubernetes.workload.name, kubescape_level, kubescape_msg, kubescape_error\n| filter kubescape_level != \"info\"\n| sort timestamp desc","visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{"[\"timestamp\"]":225,"[\"kubescape_error\"]":714,"[\"kubescape_msg\"]":523},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"},"autoSelectVisualization":true},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"15":{"title":"alert detected","type":"data","query":"fetch logs \n| filter k8s.daemonset.name==\"node-agent\"\n| filter isNotNull(ruleid)\n| summarize count() , by:{ runtimek8sdetails.workloadname , ruleid, msg, bin(timestamp,30s)}","visualization":"barChart","visualizationSettings":{"autoSelectVisualization":false,"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisScaling":"analyzedTimeframe","xAxisLabel":"bin(timestamp, 30s)","xAxisIsLabelVisible":false,"hiddenLegendFields":["count()"],"fieldMapping":{"timestamp":"bin(timestamp, 30s)","leftAxisValues":["count()"]},"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"davis":{"enabled":false,"davisVisualization":{"isAvailable":true}}},"16":{"type":"data","title":"Thread per rule","query":"timeseries avg(node_agent_rule_counter, rate: 1s), by: { rule_id }\n| fieldsAdd value.A = arrayAvg(`avg(node_agent_rule_counter, rate:1s)`)","queryConfig":{"version":"13.0.0","subQueries":[{"id":"A","isEnabled":true,"datatype":"metrics","metric":{"key":"node_agent_rule_counter","aggregation":"avg"},"by":["rule_id"],"rate":"1s"}]},"subType":"dql-builder-metrics","visualization":"pieChart","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualizationSettings":{"autoSelectVisualization":false,"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","valueAxisScale":"linear","categoryAxis":["rule_id"],"valueAxis":["value.A"],"categoryAxisLabel":"rule_id","valueAxisLabel":"value.A","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisScaling":"auto","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":["interval","value.A"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(node_agent_rule_counter, rate:1s)"]},"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto","ratio":"auto"},"dataMappings":{},"displayedFields":[],"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":{"position":"auto"},"yAxis":{"label":"Frequency","isLabelVisible":true,"scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle"},"valueBoundaries":{"min":"auto","max":"auto"}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},"layouts":{"1":{"x":0,"y":21,"w":11,"h":8},"2":{"x":11,"y":21,"w":13,"h":8},"3":{"x":0,"y":20,"w":24,"h":1},"4":{"x":0,"y":30,"w":8,"h":6},"5":{"x":0,"y":5,"w":11,"h":6},"7":{"x":8,"y":30,"w":8,"h":6},"8":{"x":16,"y":30,"w":8,"h":6},"9":{"x":0,"y":29,"w":24,"h":1},"10":{"x":11,"y":5,"w":13,"h":6},"11":{"x":0,"y":4,"w":24,"h":1},"12":{"x":0,"y":11,"w":24,"h":3},"13":{"x":0,"y":0,"w":5,"h":4},"14":{"x":0,"y":14,"w":24,"h":6},"15":{"x":5,"y":0,"w":10,"h":4},"16":{"x":15,"y":0,"w":7,"h":4}},"importedWithCode":false,"settings":{}}